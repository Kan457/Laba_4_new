#–î–∞–Ω–Ω—ã–µ –î–æ–ª–ª–∞—Ä –°–®–ê 10.01.2017 - 31.12.2019
import pandas as pd
import os
import warnings

# –ü–æ–¥–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π –æ—Ç openpyxl (–¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ü–ï–†–ï–î —á—Ç–µ–Ω–∏–µ–º —Ñ–∞–π–ª–∞)
warnings.filterwarnings('ignore', category=UserWarning)
warnings.filterwarnings('ignore', message='.*Workbook contains no default style.*')

# –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—É—Ç–∏ –∫ —Ñ–∞–π–ª—É –¥–∞–Ω–Ω—ã—Ö
script_dir = os.path.dirname(os.path.abspath(__file__))
data_path = os.path.join(script_dir, 'data.xlsx')
# –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
df = pd.read_excel(data_path)

print("\n===========================================")
print("üìç –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–• –ò–ó –§–ê–ô–õ–ê üìç")
print("===========================================\n")

print("===========================================")
# –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
print("‚öôÔ∏è  –†–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö:‚öôÔ∏è\n")
print(f"* {df.shape[0]} —Å—Ç—Ä–æ–∫üè¥\n* {df.shape[1]} —Å—Ç–æ–ª–±—Ü–æ–≤üè≥Ô∏è")

# –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –∏—Ö –æ–ø–∏—Å–∞–Ω–∏–µ
print("\n===========================================")
print("\n üìë –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤ –∏ –∑–∞ —á—Ç–æ –æ–Ω–∏ –æ—Ç–≤–µ—á–∞—é—Ç:üìë\n")
for i, col in enumerate(df.columns, 1):
    # –°–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è —Å—Ç–æ–ª–±—Ü–∞ nominal
    if str(col).lower() == 'nominal':
        col_desc = f"–ö–æ–ª-–≤–æ –¥–µ–Ω–µ–≥ üí∏"
    elif pd.api.types.is_numeric_dtype(df[col]):
        col_desc = f"–ö—É—Ä—Å üíπ"
    elif pd.api.types.is_datetime64_any_dtype(df[col]):
        col_desc = f"–î–∞—Ç–∞ üóìÔ∏è"
    else:
        col_desc = f"–ù–∞–∏–º–µ–Ω–Ω–æ–≤–∞–Ω–∏–µ –≤–∞–ª—é—Ç—ã üìù"
    print(f"  {i}. {col} - {col_desc}")

print("\n===========================================")
# –ü–µ—Ä–≤—ã–µ 5 —Å—Ç—Ä–æ–∫
print("\n‚úèÔ∏è   –í–∏–¥ :  ‚úèÔ∏è\n")
print(df)
print("\n")

print("\n===========================================")
print(" üéì –ò–°–°–õ–ï–î–û–í–ê–ù–ò–ï:üéì \n")
print("‚ö´ –ù–∞–º–∏–Ω–∞–ª –≤–∞–ª—é—Ç —Å–æ–≤–ø–∞–¥–∞–µ—Ç - 1")
print("‚ö´ –ù–∞–∏–º–µ–Ω–Ω–æ–≤–∞–Ω–∏—è –≤–∞–ª—é—Ç —Å–æ–≤–ø–∞–¥–∞—é—Ç - –î–æ–ª–ª–∞—Ä—ã –°–®–ê")
print("===========================================\n")

